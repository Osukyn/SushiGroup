<h1 class="header-title">Commande de Groupe</h1>

<div class="cart">
    <tui-accordion class="container">
        <tui-accordion-item *ngIf="orderService.getLocalOrder().items.length > 0">
            <div class="order-header">
                <div class="order-pic">
                    <tui-avatar class="order-icon" [rounded]="true"
                                [avatarUrl]="getLocalUser()?.picture || ''"></tui-avatar>
                </div>
                <div class="order-user">
                    <div class="order-title">{{ getLocalUser()?.name }}</div>
                    <div class="order-status"
                         [ngClass]="{'order-status-pending': orderService.getLocalOrder().status === OrderStatus.EN_COURS, 'order-status-confirmed': orderService.getLocalOrder().status === OrderStatus.CONFIRMEE}">{{ orderService.getLocalOrder().status }}</div>
                </div>
                <tui-money class="order-amount" [value]="getTotalForOrder(orderService.getLocalOrder())"
                           [currency]="'EUR'"></tui-money>
            </div>

            <ng-template tuiAccordionItemContent>
                <div *ngFor="let product of orderService.getLocalOrder().items">
                    <div class="product-info">
                        <div class="product-details">
                            <span class="product-quantity"><strong>{{ product.qte }}</strong></span>
                            <tui-line-clamp class="product-name" [content]="getName(product.code)"
                                            [linesLimit]="1"></tui-line-clamp>
                            <tui-money class="product-price" [value]="getTotalForProduct(product)"
                                       [currency]="'EUR'"></tui-money>
                        </div>
                    </div>
                </div>
            </ng-template>

        </tui-accordion-item>
        <tui-accordion-item *ngFor="let order of orders">
            <div class="order-header">
                <div class="order-pic">
                    <tui-avatar class="order-icon" [rounded]="true"
                                [avatarUrl]="userService.getUser(order.email)?.picture || ''"></tui-avatar>
                </div>
                <div class="order-user">
                    <div class="order-title">{{ userService.getUser(order.email)?.name }}</div>
                    <div [ngClass]="{'order-status': true,'order-status-pending': order.status === OrderStatus.EN_COURS, 'order-status-confirmed': order.status === OrderStatus.CONFIRMEE}">{{ order.status }}</div>
                </div>
                <tui-money class="order-amount" [value]="getTotalForOrder(order)" [currency]="'EUR'"></tui-money>
            </div>

            <ng-template tuiAccordionItemContent>
                <div *ngFor="let product of order.items">
                    <div class="product-info">
                        <div class="product-details">
                            <span class="product-quantity"><strong>{{ product.qte }}</strong></span>
                            <tui-line-clamp class="product-name" [content]="getName(product.code)"
                                            [linesLimit]="1"></tui-line-clamp>
                            <tui-money class="product-price" [value]="getTotalForProduct(product)"
                                       [currency]="'EUR'"></tui-money>
                        </div>
                    </div>
                </div>
            </ng-template>
        </tui-accordion-item>
    </tui-accordion>

    <div class="total" *ngIf="getTotalCost() > 0">
        Total:
        <tui-money class="total-amount" [value]="getTotalCost() || 0" [currency]="'EUR'"></tui-money>
    </div>
    <h2 *ngIf="getTotalCost() === 0">Panier vide</h2>
</div>
